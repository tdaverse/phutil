<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Persistence Homology Utilities • phutil</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Persistence Homology Utilities">
<meta name="description" content="Implements a class for hosting persistence homology information in the form of a persistence diagram. The package also provides a set of functions to manipulate persistence diagrams, such as coercing them to different formats for compatibility with other packages or plotting them.">
<meta property="og:description" content="Implements a class for hosting persistence homology information in the form of a persistence diagram. The package also provides a set of functions to manipulate persistence diagrams, such as coercing them to different formats for compatibility with other packages or plotting them.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">phutil</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/validation-benchmark.html">Validation and Benchmark of Wasserstein Distances</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tdaverse/phutil/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="phutil">phutil<a class="anchor" aria-label="anchor" href="#phutil"></a>
</h1></div>
<!-- badges: start -->

<p>The goal of the {phutil} package is to provide utility functions for persistence data analysis. In particular, the package defines a data structure for hosting persistence data. The package is part of the <a href="https://github.com/tdaverse" class="external-link"><em>tdaverse</em></a> suite of packages, which aims to provide a consistent interface for topological data analysis in R that nicely integrates with the <a href="https://www.tidymodels.org" class="external-link"><em>tidymodels</em></a> ecosystem.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of {phutil} from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("pak")</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pak.html" class="external-link">pak</a></span><span class="op">(</span><span class="st">"tdaverse/phutil"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="the-persistence-class">The ‘persistence’ class<a class="anchor" aria-label="anchor" href="#the-persistence-class"></a>
</h2>
<p>The package currently provides a new data structure for hosting persistence data. The data set <code>noisy_circle_points</code> is a simulated data set consisting of 100 points sampled from a circle with additive Gaussian noise using a standard deviation of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0.05</mn><annotation encoding="application/x-tex">0.05</annotation></semantics></math>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tdaverse/phutil" class="external-link">phutil</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">noisy_circle_points</span><span class="op">)</span></span>
<span><span class="co">#&gt;               x          y</span></span>
<span><span class="co">#&gt; [1,]  0.6651721  0.6363172</span></span>
<span><span class="co">#&gt; [2,] -0.7481066 -0.6901262</span></span>
<span><span class="co">#&gt; [3,] -0.8288544 -0.5519689</span></span>
<span><span class="co">#&gt; [4,] -0.7650181 -0.7436499</span></span>
<span><span class="co">#&gt; [5,]  0.6337296 -0.7607464</span></span>
<span><span class="co">#&gt; [6,] -0.6077663 -0.7036492</span></span></code></pre></div>
<p>The data set <code>noisy_circle_ripserr</code> is a persistence diagram computed using the <a href="https://tdaverse.github.io/ripserr/" class="external-link"><strong>ripserr</strong></a> package with the <a href="https://tdaverse.github.io/ripserr/reference/vietoris_rips.html" class="external-link"><code>ripserr::vietoris_rips()</code></a> and stored as an object of class ‘PHom’, which is a light wrapper around a data frame with 3 variables:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">noisy_circle_ripserr</span><span class="op">)</span></span>
<span><span class="co">#&gt;   dimension birth       death</span></span>
<span><span class="co">#&gt; 1         0     0 0.008162723</span></span>
<span><span class="co">#&gt; 2         0     0 0.008548402</span></span>
<span><span class="co">#&gt; 3         0     0 0.009238432</span></span>
<span><span class="co">#&gt; 4         0     0 0.014004707</span></span>
<span><span class="co">#&gt; 5         0     0 0.020555701</span></span>
<span><span class="co">#&gt; 6         0     0 0.024621462</span></span></code></pre></div>
<p>The data set <code>noisy_circle_tda_rips</code> is a persistence diagram computed using the <strong>TDA</strong> package with the <a href="https://www.rdocumentation.org/packages/TDA/versions/1.9.1/topics/ripsDiag" class="external-link"><code>TDA::ripsDiag()</code></a> and stored as a list of length 1 containing the object <code>diagram</code> of class ‘diagram’, which is a matrix with 3 columns:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">noisy_circle_tda_rips</span><span class="op">$</span><span class="va">diagram</span><span class="op">)</span></span>
<span><span class="co">#&gt;      dimension Birth     Death</span></span>
<span><span class="co">#&gt; [1,]         0     0 1.6322000</span></span>
<span><span class="co">#&gt; [2,]         0     0 0.3677392</span></span>
<span><span class="co">#&gt; [3,]         0     0 0.3325817</span></span>
<span><span class="co">#&gt; [4,]         0     0 0.3226673</span></span>
<span><span class="co">#&gt; [5,]         0     0 0.2096916</span></span>
<span><span class="co">#&gt; [6,]         0     0 0.1953531</span></span></code></pre></div>
<p>The data structure adopted by the <em>tdaverse</em> suite of packages and provided by this package is designed to be a common interface for persistence data. This allows for a seamless integration of persistence data across different packages and ensures that the data is always in a consistent format.</p>
<p>Specifically, the ‘persistence’ class is a list with the following components:</p>
<ul>
<li><p><code>pairs</code>: A list of 2-column matrices containing birth-death pairs. The -<em>th</em> element of the list corresponds to the -<em>th</em> homology dimension. If there is no pairs for a given dimension but there are pairs in higher dimensions, the corresponding element(s) is/are filled with a numeric matrix.</p></li>
<li>
<p><code>metadata</code>: A list of length 6 containing information about how the data was computed:</p>
<ul>
<li>
<code>orderered_pairs</code>: A boolean indicating whether the pairs in the <code>pairs</code> list are ordered (i.e. the first column is strictly less than the second column).</li>
<li>
<code>data</code>: The name of the object containing the original data on which the persistence data was computed.</li>
<li>
<code>engine</code>: The name of the package and the function of this package that computed the persistence data in the form <code>"package_name::package_function"</code>.</li>
<li>
<code>filtration</code>: The filtration used in the computation in a human-readable format (i.e. full names, capitals where need, etc.).</li>
<li>
<code>parameters</code>: A list of parameters used in the computation.</li>
<li>
<code>call</code>: The exact call that generated the persistence data.</li>
</ul>
</li>
</ul>
<p>The <code><a href="reference/persistence.html">as_persistence()</a></code> function is used to convert persistence data from different packages into the ‘persistence’ class. For example, the persistence data computed using the <strong>ripserr</strong> package can be converted into the ‘persistence’ class as follows:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/persistence.html">as_persistence</a></span><span class="op">(</span><span class="va">noisy_circle_ripserr</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── Persistence Data ────────────────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt; ℹ There are 99 and 2 pairs in dimensions 0 and 1 respectively.</span></span>
<span><span class="co">#&gt; ℹ Computed from a Vietoris-Rips/Cubical filtration using `ripserr::&lt;vietoris_rips/cubical&gt;()`.</span></span>
<span><span class="co">#&gt; ! With unknown parameters.</span></span></code></pre></div>
<p>Similarly, the persistence data computed using the <strong>TDA</strong> package can be converted into the ‘persistence’ class as follows:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/persistence.html">as_persistence</a></span><span class="op">(</span><span class="va">noisy_circle_tda_rips</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── Persistence Data ────────────────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt; ℹ There are 100 and 2 pairs in dimensions 0 and 1 respectively.</span></span>
<span><span class="co">#&gt; ℹ Computed from a Vietoris-Rips filtration using `TDA::ripsDiag()`.</span></span>
<span><span class="co">#&gt; ℹ With the following parameters: maxdimension = 1 and maxscale = 1.6322.</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="distances-between-persistence-diagrams">Distances between persistence diagrams<a class="anchor" aria-label="anchor" href="#distances-between-persistence-diagrams"></a>
</h2>
<p>The package also provides a function to compute the bottleneck distance between two persistence diagrams. The function <code><a href="reference/distances.html">bottleneck_distance()</a></code> takes two persistence diagrams as input and computes the bottleneck distance between them:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tdaverse/phutil" class="external-link">phutil</a></span><span class="op">)</span></span>
<span><span class="va">diag1</span> <span class="op">&lt;-</span> <span class="va">persistence_sample</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">diag2</span> <span class="op">&lt;-</span> <span class="va">persistence_sample</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu"><a href="reference/distances.html">bottleneck_distance</a></span><span class="op">(</span><span class="va">diag1</span>, <span class="va">diag2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.06197453</span></span></code></pre></div>
<p>One can also compute the Wasserstein distance between two persistence diagrams using the <code><a href="reference/distances.html">wasserstein_distance()</a></code> function:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/distances.html">wasserstein_distance</a></span><span class="op">(</span><span class="va">diag1</span>, <span class="va">diag2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1.53403</span></span></code></pre></div>
<p>It is also possible to compute these distances between all pairs of persistence diagrams in a list using e.g. <code><a href="reference/pairwise-distances.html">wasserstein_pairwise_distances()</a></code>:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/pairwise-distances.html">wasserstein_pairwise_distances</a></span><span class="op">(</span><span class="va">persistence_sample</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;          1        2        3        4</span></span>
<span><span class="co">#&gt; 2 1.534030                           </span></span>
<span><span class="co">#&gt; 3 2.301812 1.852241                  </span></span>
<span><span class="co">#&gt; 4 2.354967 2.362616 1.922799         </span></span>
<span><span class="co">#&gt; 5 2.374818 2.707366 1.985518 3.154120</span></span></code></pre></div>
<p>It returns an object of class ‘dist’. It is parallelized using <a href="https://www.openmp.org/" class="external-link">OpenMP</a> and relies under the hood on the <a href="https://github.com/anigmetov/hera" class="external-link">Hera</a> C++ library which is BSD-licensed. The code interfacing R and C++ is generated by the header-only <a href="https://cpp11.r-lib.org" class="external-link">{cpp11}</a> package which is MIT-licensed.</p>
</div>
<div class="section level2">
<h2 id="contributions">Contributions<a class="anchor" aria-label="anchor" href="#contributions"></a>
</h2>
<div class="section level3">
<h3 id="code-of-conduct">Code of Conduct<a class="anchor" aria-label="anchor" href="#code-of-conduct"></a>
</h3>
<p>Please note that the {phutil} package is released with a <a href="https://tdaverse.github.io/phutil/CODE_OF_CONDUCT.html">Contributor Code of Conduct</a>. By contributing to this project, you agree to abide by its terms.</p>
</div>
<div class="section level3">
<h3 id="acknowledgments">Acknowledgments<a class="anchor" aria-label="anchor" href="#acknowledgments"></a>
</h3>
<p>This project was funded by <a href="https://r-consortium.org/all-projects/2024-group-1.html#modular-interoperable-and-extensible-topological-data-analysis-in-r" class="external-link">an ISC grant from the R Consortium</a> and done in coordination with Jason Cory Brunson and with guidance from Bertrand Michel and Paul Rosen. It builds upon conversations with Mathieu Carrière and Vincent Rouvreau who are among the authors of the <a href="https://gudhi.inria.fr" class="external-link">GUDHI</a> library. Package development also benefited from the support of colleagues at the <a href="https://www.math.sciences.univ-nantes.fr" class="external-link">Department of Mathematics Jean Leray</a> and the use of equipment at <a href="https://english.univ-nantes.fr" class="external-link">Nantes University</a>.</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/tdaverse/phutil/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/tdaverse/phutil/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing phutil</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Aymeric Stamm <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-8725-3654" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Jason Cory Brunson <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0003-3126-9494" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/tdaverse/phutil/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/tdaverse/phutil/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://app.codecov.io/gh/tdaverse/phutil" class="external-link"><img src="https://codecov.io/gh/tdaverse/phutil/graph/badge.svg" alt="Codecov test coverage"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Aymeric Stamm, Jason Cory Brunson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
