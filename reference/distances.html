<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Distances between two persistence diagrams — distances • phutil</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Distances between two persistence diagrams — distances"><meta name="description" content="This collection of functions computes the distance between two persistence
diagrams of the same homology dimension. The diagrams must be represented as
2-column matrices. The first column of the matrix contains the birth times
and the second column contains the death times of the points."><meta property="og:description" content="This collection of functions computes the distance between two persistence
diagrams of the same homology dimension. The diagrams must be represented as
2-column matrices. The first column of the matrix contains the birth times
and the second column contains the death times of the points."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">phutil</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/persistence-class.html">The persistence class</a></li>
    <li><a class="dropdown-item" href="../articles/validation-benchmark.html">Validation and Benchmark of Wasserstein Distances</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tdaverse/phutil/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Distances between two persistence diagrams</h1>
      <small class="dont-index">Source: <a href="https://github.com/tdaverse/phutil/blob/main/R/distances.R" class="external-link"><code>R/distances.R</code></a></small>
      <div class="d-none name"><code>distances.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This collection of functions computes the distance between two persistence
diagrams of the same homology dimension. The diagrams must be represented as
2-column matrices. The first column of the matrix contains the birth times
and the second column contains the death times of the points.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">bottleneck_distance</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  tol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">.Machine</span><span class="op">$</span><span class="va">double.eps</span><span class="op">)</span>,</span>
<span>  validate <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  dimension <span class="op">=</span> <span class="fl">0L</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">wasserstein_distance</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  tol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">.Machine</span><span class="op">$</span><span class="va">double.eps</span><span class="op">)</span>,</span>
<span>  p <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  validate <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  dimension <span class="op">=</span> <span class="fl">0L</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">kantorovich_distance</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  tol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">.Machine</span><span class="op">$</span><span class="va">double.eps</span><span class="op">)</span>,</span>
<span>  p <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  validate <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  dimension <span class="op">=</span> <span class="fl">0L</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Either a matrix of shape \(n \times 2\) or an object of class
<a href="persistence.html">persistence</a> specifying the first persistence diagram.</p></dd>


<dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>Either a matrix of shape \(m \times 2\) or an object of class
<a href="persistence.html">persistence</a> specifying the second persistence diagram.</p></dd>


<dt id="arg-tol">tol<a class="anchor" aria-label="anchor" href="#arg-tol"></a></dt>
<dd><p>A numeric value specifying the relative error. Defaults to
<code>sqrt(.Machine$double.eps)</code>. For the Bottleneck distance, it can be set to
<code>0.0</code> in which case the exact Bottleneck distance is computed, while an
approximate Bottleneck distance is computed if <code>tol &gt; 0.0</code>. For the
Wasserstein distance, it must be strictly positive.</p></dd>


<dt id="arg-validate">validate<a class="anchor" aria-label="anchor" href="#arg-validate"></a></dt>
<dd><p>A boolean value specifying whether to validate the input
persistence diagrams. Defaults to <code>TRUE</code>. If <code>FALSE</code>, the function will not
check if the input persistence diagrams are valid. This can be useful for
performance reasons, but it is recommended to keep it <code>TRUE</code> for safety.</p></dd>


<dt id="arg-dimension">dimension<a class="anchor" aria-label="anchor" href="#arg-dimension"></a></dt>
<dd><p>An integer value specifying the homology dimension for which
to compute the distance. Defaults to <code>0L</code>. This is only used if <code>x</code> and <code>y</code>
are objects of class <a href="persistence.html">persistence</a>.</p></dd>


<dt id="arg-p">p<a class="anchor" aria-label="anchor" href="#arg-p"></a></dt>
<dd><p>A numeric value specifying the power for the Wasserstein distance.
Defaults to <code>1.0</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A numeric value storing either the Bottleneck or the Wasserstein
distance between the two persistence diagrams.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>A matching \(\varphi : D_1 \to D_2\) between persistence diagrams is a
bijection of multisets, where both diagrams are assumed to have all points on
the diagonal with infinite multiplicity. The <em>\(p\)-Wasserstein distance</em>
between \(D_1\) and \(D_2\) is defined as the infimum over all matchings
of the expression</p>
<p>$$W_p(D_1,D_2) = \inf_{\varphi: D_1 \to D_2}
\left( \sum_{x \in D_1}{\lVert x - \varphi(x) \rVert^p}
\right)^{\frac{1}{p}}$$</p>
<p>that can be thought of as the Minkowski distance between the diagrams viewed
as vectors on the shared coordinates defined by the matching \(\varphi\).
The norm \(\lVert \cdot \rVert\) can be arbitrary; as implemented here, it
is the infinity norm \(\lVert (x_1,x_2) \rVert_\infty = \max(x_1,x_2)\). In
the limit \(p \to \infty\), the Wasserstein distance becomes the
<em>bottleneck distance</em>:</p>
<p>$$B(D_1,D_2) = \inf_{\varphi: D_1 \to D_2}
\sup_{x \in D_1}{\lVert x - \varphi(x) \rVert}.$$</p>
<p>The Wasserstein metric is also called the Kantorovich metric in recognition
of the originator of the metric.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="https://github.com/anigmetov/hera" class="external-link">the Hera C++ library</a></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">bottleneck_distance</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">persistence_sample</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">pairs</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  <span class="va">persistence_sample</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">pairs</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.06197453</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">bottleneck_distance</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">persistence_sample</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  <span class="va">persistence_sample</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.06197453</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">wasserstein_distance</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">persistence_sample</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">pairs</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  <span class="va">persistence_sample</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">pairs</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.53403</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">wasserstein_distance</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">persistence_sample</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  <span class="va">persistence_sample</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.53403</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Aymeric Stamm, Jason Cory Brunson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

